% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_cox_cluster.R
\name{fit_cox_cluster}
\alias{fit_cox_cluster}
\alias{survfit_strata_cluster}
\title{Fit Cox model with optional strata and clustering (robust / frailty / coxme)}
\usage{
fit_cox_cluster(
  data,
  time,
  status = NULL,
  event = NULL,
  covars = character(),
  strata = NULL,
  strata_var = NULL,
  cluster = NULL,
  cluster_id = NULL,
  engine = c("coxph_robust", "frailty", "coxme"),
  ties = "efron",
  event_code = NULL
)

survfit_strata_cluster(
  data,
  time,
  status = NULL,
  event = NULL,
  covars = character(),
  strata = NULL,
  strata_var = NULL,
  cluster = NULL,
  cluster_id = NULL,
  engine = c("coxph_robust", "frailty", "coxme"),
  ties = "efron",
  event_code = NULL
)
}
\arguments{
\item{data}{A data.frame containing the survival data.}

\item{time}{Character. Name of the time-to-event column.}

\item{status}{Character. Name of the event indicator column (0/1 or 1/2 where 2 = event).}

\item{event}{Deprecated alias for \code{status}. Used only if \code{status} is missing.}

\item{covars}{Character vector of covariate column names (e.g., c("age","sex")).}

\item{strata}{Character or NULL. Name of stratification variable.}

\item{strata_var}{Deprecated alias for \code{strata}.}

\item{cluster}{Character or NULL. Name of the clustering ID variable.}

\item{cluster_id}{Deprecated alias for \code{cluster}.}

\item{engine}{Character. One of c("coxph_robust","frailty","coxme"). Default is "coxph_robust".}

\item{ties}{Character. Method for handling ties in \code{coxph} ("efron" by default).}

\item{event_code}{Optional integer. Code of event if not 0/1 (e.g., 2 if coded 1/2).}
}
\value{
A fitted model object (from \code{coxph} or \code{coxme}) with relevant attributes.
}
\description{
Fits a Cox proportional hazards model that can include stratification
and clustering. Supported engines:
\itemize{
\item "coxph_robust": Uses \code{survival::coxph} with \code{cluster()} (robust sandwich SE)
\item "frailty": Uses \code{survival::coxph} with \code{frailty()}
\item "coxme": Uses \code{coxme::coxme} (random effect for cluster)
}
}
\details{
The function accepts both \strong{modern} and \strong{legacy aliases} for parameters:
\itemize{
\item \code{status} ⇐ alias: \code{event}
\item \code{strata} ⇐ alias: \code{strata_var}
\item \code{cluster} ⇐ alias: \code{cluster_id}
}
}
\examples{
\dontshow{if (requireNamespace("survival", quietly = TRUE)) withAutoprint(\{ # examplesIf}
lung <- survival::lung
lung$status01 <- as.integer(lung$status == 2)
lung$id <- seq_len(nrow(lung))

# Using modern argument names
m1 <- fit_cox_cluster(
  data = lung, time = "time", status = "status01",
  covars = c("age","sex"), cluster = "id",
  engine = "coxph_robust"
)
summary(m1)

# Using legacy aliases (event / cluster_id / strata_var)
m2 <- fit_cox_cluster(
  data = lung, time = "time", event = "status01",
  covars = c("age","sex"), cluster_id = "id",
  strata_var = NULL, engine = "coxph_robust"
)
summary(m2)
\dontshow{\}) # examplesIf}
}
